"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3241],{3944:function(t,e,n){var a=n(1527);e.Z=t=>{let{iconName:e,className:n}=t;return(0,a.jsx)("svg",{className:n,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:(0,a.jsx)("use",{xlinkHref:"/svg/sprite.svg#".concat(e),width:"100%",height:"100%"})})}},6988:function(t,e,n){n.d(e,{A:function(){return v},G:function(){return h}});var a=n(1527),i=n(959),o=n(2349),r=n(1043),s=n(4402),l=n(2390),u=n(5467);let c=(0,i.createContext)({data:null,setData:null,branches:[],setBranches:null,installments:[],variants:new Map,isInBasket:!1,installmentMonths:[],changedMonth:12,changedType:null,similar:null,open:!1,disabled:!1,setChangedMonth:null,setChangedType:null,setOpen:null,isLiked:!1,isCompared:!1,reviews:{count:0,reviews:[]},setReviews:null}),d={limit:"50",offset:"0",visible:"false",active:"true"},h=t=>{var e;let{children:n}=t,{setLoading:h}=(0,r.r$)(),[v,p]=(0,i.useState)(null),{t:f,i18n:m}=(0,s.$G)(),g=(0,o.useRouter)(),[w,S]=(0,i.useState)(null),[y,_]=(0,i.useState)([]),[b,E]=(0,i.useState)(new Map),[A,k]=(0,i.useState)(!1),[O,C]=(0,i.useState)(!1),[N,R]=(0,i.useState)(!1),{basketProducts:U,likedProducts:J,comparedProducts:T}=(0,r.ol)(),[x,P]=(0,i.useState)([]),[L,j]=(0,i.useState)(12),[I,M]=(0,i.useState)(null),[Z,B]=(0,i.useState)(null),{open:q,setOpen:z}=(0,u.Z)(),[D,G]=(0,i.useState)(!1),[H,F]=(0,i.useState)({count:0,reviews:[]});return(0,i.useEffect)(()=>{v&&(C(!!(null==J?void 0:J.includes(null==v?void 0:v.id))),R(!!(null==T?void 0:T.includes(null==v?void 0:v.id))),k(!!(null==U?void 0:U[v.id])))},[T,v,J,U]),(0,i.useEffect)(()=>{let t=async()=>{var t;let e=String(null===(t=g.query)||void 0===t?void 0:t.id);if(!e)return;let{getProduct:n,getInstalments:a,getProductBranches:i,getSimilar:o}=l.product_service;try{(null==v?void 0:v.id)&&(null==h||h(!0));let[t,r,s]=await Promise.all([n(e),a(d),i(e,"")]);G((null==t?void 0:t.is_available)!=="available"),p(t),S(null==s?void 0:s.product_branchs),null==h||h(!1);let l=(null==r?void 0:r.payment_methods)||[];_(l);let u=new Set;l.forEach(t=>{var e;null==t||null===(e=t.installment_types)||void 0===e||e.forEach(t=>{u.add(null==t?void 0:t.month)})});let c=Array.from(u).map(t=>({label:"".concat(t," ").concat(f("products.month"),"."),value:"".concat(t)}));P(c);let m=await o(null==t?void 0:t.subcategory_ids,e);B(null==m?void 0:m.products)}catch(t){console.error("Error fetching data:",t)}};t()},[null===(e=g.query)||void 0===e?void 0:e.id,f]),(0,i.useEffect)(()=>{var t,e;if(!(null==v?void 0:v.variant)||!(null==v?void 0:null===(t=v.child_products)||void 0===t?void 0:t.length)||!(null==v?void 0:null===(e=v.variant)||void 0===e?void 0:e.attributes))return;let{variant:n,child_products:a,attributes:i}=v,o=new Map;n.attributes.forEach(t=>{o.set(t.id,new Set)});let r=[...i,...a.flatMap(t=>t.attributes)];r.forEach(t=>{var e,n;(null===(e=t.choices)||void 0===e?void 0:e.at(0))&&(null===(n=o.get(t.id))||void 0===n||n.add(JSON.stringify(t.choices.at(0))))}),o.forEach((t,e)=>{let n=Array.from(t).sort((t,e)=>{var n,a,i,o;let r=(null===(a=JSON.parse(String(t)||"{}"))||void 0===a?void 0:null===(n=a.name)||void 0===n?void 0:n[m.language])||"",s=(null===(o=JSON.parse(String(e)||"{}"))||void 0===o?void 0:null===(i=o.name)||void 0===i?void 0:i[m.language])||"";return r.localeCompare(s)});o.set(e,new Set(n))}),E(o)},[v,m.language]),(0,a.jsx)(c.Provider,{value:{data:v,setData:p,branches:w,setBranches:S,installments:y,variants:b,isInBasket:A,installmentMonths:x,changedMonth:L,changedType:I,similar:Z,open:q,disabled:D,setChangedMonth:j,setChangedType:M,setOpen:z,isLiked:O,isCompared:N,reviews:H,setReviews:F},children:(0,a.jsx)(c.Consumer,{children:()=>n})})},v=()=>{let t=(0,i.useContext)(c);return{...t}}},3578:function(t,e,n){function a(t){var e,n;if(t.headers&&(null===(e=t.url)||void 0===e?void 0:e.includes("/auth"))){let e=JSON.parse(window.localStorage.getItem("userAuth")||"{}");t.headers.Authorization="Bearer ".concat(null==e?void 0:null===(n=e.token)||void 0===n?void 0:n.access_token)}return t}function i(t){return Promise.reject(t)}function o(t){return t}function r(t){var e;(null===(e=t.response)||void 0===e?void 0:e.status)===401?(localStorage.setItem("userAuth",JSON.stringify(null)),window.location.href="/"):t.code}n.d(e,{Z:function(){return d}});var s=n(3669);class l{get(t,e){return this.api({...e,url:t,method:"GET"})}post(t,e,n){return this.api({...n,url:t,method:"POST",data:e})}put(t,e,n){return this.api({...n,url:t,method:"PUT",data:e})}patch(t,e,n){return this.api({...n,url:t,method:"PATCH",data:e})}delete(t,e){return this.api({...e,url:t,method:"DELETE"})}constructor(){this.api=s.Z,this.adminUrl="https://api.admin.newmediapark.uz/v1/",this.authUrl="https://api.auth.newmediapark.uz/"}}class u extends l{constructor(){super(),this.api=s.Z.create({baseURL:this.adminUrl}),this.api.interceptors.request.use(a,i),this.api.interceptors.response.use(o,r)}}class c extends l{constructor(){super(),this.api=s.Z.create({baseURL:this.authUrl}),this.api.interceptors.request.use(a,i),this.api.interceptors.response.use(o,r)}}var d=class{constructor(){this.adminService=new u,this.authService=new c}}},9:function(t,e,n){n.d(e,{I8:function(){return o},SA:function(){return i}});class a{constructor(t){var e=this;this._fetchJSON=async function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object.keys(n.query||{}).map(t=>{var e;return encodeURIComponent(t)+"="+encodeURIComponent((null==n?void 0:null===(e=n.query)||void 0===e?void 0:e[t])||"")}).join("&"),i=n.body instanceof FormData,o={...e._headers,...null==n?void 0:n.headers},r=await fetch(e._baseURL+t+(a?"?".concat(a):""),{...n,body:i?n.body:JSON.stringify(n.body),headers:o});if(!r.ok)throw Error("".concat(r.status,": ").concat(null==r?void 0:r.statusText));return!1!==n.parseResponse&&204!==r.status?r.json():r},this.setBasicAuth=t=>(this._headers.Authorization="Bearer ".concat(t),this),this.setHeader=(t,e)=>(this._headers[t]=e,this),this.get=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e._fetchJSON(t,{...n,method:"GET"})},this.post=function(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e._fetchJSON(t,{...a,body:n,method:"POST"})},this.patch=function(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n instanceof FormData;return e._fetchJSON(t,{...a,body:i?n:JSON.stringify(n),method:"PATCH"})},this.put=function(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e._fetchJSON(t,{...a,body:n,method:"PUT"})},this.delete=function(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n instanceof FormData;return e._fetchJSON(t,{...a,body:i?n:JSON.stringify(n),method:"DELETE"})},this._baseURL=t.baseURL||"",this._headers=t.headers||{}}}let i=new a({baseURL:"".concat("https://api.admin.newmediapark.uz/v1/"),headers:{"Content-Type":"application/json"}}),o=new a({baseURL:"".concat("https://api.auth.newmediapark.uz/"),headers:{"Content-Type":"application/json"}})},2390:function(t,e,n){n.d(e,{product_service:function(){return s}});var a=n(8338),i=n(9),o=n(3578);class r extends o.Z{async getProduct(t){let e=JSON.parse(localStorage.getItem("location")||"{}"),n=await i.SA.get("variants-product/".concat(t,"?region_id=").concat((null==e?void 0:e.id)||a.Ce));return null==n?void 0:n.data}async getProductBranches(t,e){let n=await i.SA.get("product-branches/".concat(t).concat(e));return null==n?void 0:n.data}async getMeta(t){let e=await i.SA.get("product_card/".concat(t));return null==e?void 0:e.data}async getInstalments(t){let e=new URLSearchParams(t),n=await i.SA.get("payment-method-v2?".concat(e));return null==n?void 0:n.data}async getSimilar(t,e){let n=await i.SA.get("product_card?subcategory_ids=".concat(t,"&limit=12&offset=0&not_ids=").concat([e]));return null==n?void 0:n.data}async getReviews(t,e,n,a,o,r){let s=await i.SA.get("product-review?limit=".concat(n,"&offset=").concat(e,"&product_id=").concat(t,"&status=active&user_id=").concat(a||"","&sort_status=").concat(o||"","&sort_rate=").concat(r||""));return null==s?void 0:s.data}async postReview(t){let e=await i.SA.post("product-review",t);return null==e?void 0:e.data}async postComment(t){let e=await i.SA.post("comment",t);return null==e?void 0:e.data}async postReviewReaction(t){let e=await i.SA.post("like-dislike",t);return null==e?void 0:e.data}async getComments(t,e){let n=await i.SA.get("comment?reference_id=".concat(t,"&status=active&user_id=").concat(e||""));return null==n?void 0:n.data}async uploadImage(t){try{let e=await this.adminService.post("upload",t);return null==e?void 0:e.data}catch(t){console.log(t)}}}let s=new r},5089:function(t,e,n){n.d(e,{E:function(){return a}});let a=t=>{var e;return null==t?null:null==t?void 0:null===(e=t.toString())||void 0===e?void 0:e.replace(/\B(?=(\d{3})+(?!\d))/g," ")}},5467:function(t,e,n){var a=n(959);e.Z=function(){let[t,e]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{t?window.document.body.style.overflow="hidden":window.document.body.style.overflow="auto"},[t]),{open:t,setOpen:e}}}}]);